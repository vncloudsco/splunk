(window.webpackJsonp=window.webpackJsonp||[]).push([[78],{"views/shared/ResultsTableDrillDownPopTart":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__("require/underscore"),__webpack_require__("shim/jquery"),module,__webpack_require__("views/shared/PopTart"),__webpack_require__("models/shared/TimeRange"),__webpack_require__("util/time"),__webpack_require__("shim/splunk.util"),__webpack_require__("stubs/i18n")],void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(_,$,module,PopTart,TimeRangeModel,time_utils,splunkUtil,i18n){return PopTart.extend({moduleId:module.i,className:"dropdown-menu dropdown-menu-medium",initialize:function(options){PopTart.prototype.initialize.apply(this,arguments),this.model.spanTimeRange=new TimeRangeModel,this.constraints={keys:[],values:[]},this.fields=this.model.results.getDataFields(),this.isTimeSpan=_.has(this.options.clickMeta,"_span"),this.fieldClicked=_.has(this.options.clickMeta,"name2")?this.options.clickMeta.name2:this.options.clickMeta.name,this.fieldValueClicked=_.has(this.options.clickMeta,"value2")?this.options.clickMeta.value2:this.options.clickMeta.value,this.fieldMetadataResults=this.convertResultFieldsToMetadata(),this.metaDataHasGroupByOrSplitBy=!_.isUndefined(_.find(this.fieldMetadataResults,function(fieldMetaData){return fieldMetaData.groupby_rank||fieldMetaData.splitby_field})),this.fieldClickedMetaData=this.fieldMetadataResults[this.fieldClicked]||{},this.cellDrilldownable=this.isCellDrilldownable(),this.hasRenderedDeferred=$.Deferred(),this.cellDrilldownable&&(this.splitbyField=this.fieldClickedMetaData?this.fieldClickedMetaData.splitby_field:void 0,this.splitbyValue=this.splitbyField?this.fieldClickedMetaData.splitby_value:void 0,!this.isTimeSpan||this.splitbyField||this.splitbyValue||(this.splitbyField=this.fieldClicked,this.splitbyValue=this.fieldValueClicked),this.fieldClickedRank=this.metaDataHasGroupByOrSplitBy?this.fieldClickedMetaData.groupby_rank:this.fields.indexOf(this.fieldClicked).toString()),this.metaDataHasGroupByOrSplitBy?this.buildConstraintsByGroupBy():this.buildConstraintsByFieldIndex(),this.isTimeSpan&&(this.timeSpanDfd=this.model.spanTimeRange.save({earliest:this.options.clickMeta.value,latest:(parseFloat(this.options.clickMeta.value)+this.options.clickMeta._span).toFixed(3)}))},convertResultFieldsToMetadata:function(){var metadata={},fields=this.model.results.get("fields");return _(fields).each(function(fieldObj){_.isObject(fieldObj)&&(metadata[fieldObj.name]=_(fieldObj).omit("name"))}),metadata},stripClickMetaToTimeRange:function(){return _.extend(_(this.options.clickMeta).omit("name2","value2"),{rowContext:_(this.options.clickMeta).pick("row._time")})},stripClickMetaToColumnOnly:function(){var clickMeta=this.options.clickMeta;return clickMeta.name2?_(clickMeta).omit("name","value","_span"):$.extend(!0,{},this.options.clickMeta)},isCellDrilldownable:function(){if("row"===this.options.clickMeta.type||"_time"===this.fieldClicked)return!1;if(this.metaDataHasGroupByOrSplitBy){if(!this.fieldClickedMetaData||!this.fieldClickedMetaData.groupby_rank&&!this.fieldClickedMetaData.splitby_field)return!1}else if(this.fieldClickedMetaData){var type_special=this.fieldClickedMetaData.type_special;if("count"===type_special||"percent"===type_special)return!1}return!0},buildConstraintsByGroupBy:function(){for(var i=0;i<this.fields.length;i++){var groupbyRank,key=this.fields[i],fieldMetaData=this.fieldMetadataResults[key];if(fieldMetaData&&fieldMetaData.groupby_rank)if(groupbyRank=parseInt(fieldMetaData.groupby_rank,10),!this.fieldClickedRank||groupbyRank<this.fieldClickedRank)this.constraints.keys.push(key),this.constraints.values.push(this.options.clickMeta.rowContext["row."+key]);else{if(!this.fieldClickedRank||groupbyRank!=this.fieldClickedRank)break;this.constraints.keys.push(key),this.constraints.values.push(this.fieldValueClicked)}}},buildConstraintsByFieldIndex:function(){for(var maxIndex=_.isUndefined(this.fieldClickedRank)?this.fields.length:this.fieldClickedRank,i=0;i<maxIndex;i++){var fieldKey=this.fields[i];if(this.fieldMetadataResults&&this.fieldMetadataResults[fieldKey]){var type_special=this.fieldMetadataResults[fieldKey].type_special;if("count"===type_special||"percent"===type_special)continue}this.constraints.keys.push(fieldKey),this.constraints.values.push(this.options.clickMeta.rowContext["row."+fieldKey])}i==this.fieldClickedRank&&(this.constraints.keys.push(this.fields[i]),this.constraints.values.push(this.fieldValueClicked))},events:{"click .time_span":function(e){var clickMeta=_.extend({},this.options.clickMeta,{type:"row"});this.fieldDrilldown(e,clickMeta)},"click .time_span_reporting":function(e){this.fieldDrilldown(e,this.stripClickMetaToTimeRange(),{stripReportsSearch:!1})},"click .splitby_curr_inc_cell":function(e){this.fieldDrilldown(e,this.options.clickMeta)},"click .curr_exc_cell":function(e){this.fieldDrilldown(e,this.stripClickMetaToColumnOnly(),{stripReportsSearch:!1,negate:!0})},"click .curr_inc_val":function(e){var strippedClickMeta=this.stripClickMetaToColumnOnly(),columnName=strippedClickMeta.name2||strippedClickMeta.name,columnMeta=columnName&&this.fieldMetadataResults[columnName];columnMeta&&columnMeta.hasOwnProperty("groupby_rank")||this.cellDrilldownable||(strippedClickMeta.type="row"),this.fieldDrilldown(e,strippedClickMeta)},"click .curr_exc_val":function(e){var strippedClickMeta=this.stripClickMetaToColumnOnly(),columnName=strippedClickMeta.name2||strippedClickMeta.name,columnMeta=columnName&&this.fieldMetadataResults[columnName];columnMeta&&columnMeta.hasOwnProperty("groupby_rank")||(strippedClickMeta.type="row"),this.fieldDrilldown(e,strippedClickMeta,{negate:!0})},"click .only_val":function(e){this.fieldDrilldown(e,this.stripClickMetaToColumnOnly(),{newSearch:!0})},"click .curr_inc_con":function(e){this.fieldDrilldown(e,this.options.clickMeta,{fields:this.constraints.keys,values:this.constraints.values})},"click .curr_exc_con":function(e){this.fieldDrilldown(e,this.options.clickMeta,{fields:this.constraints.keys,values:this.constraints.values,negate:!0})}},fieldDrilldown:function(e,clickInfo,options){e.preventDefault(),(options=options||{}).drilldownNewTab=$(e.currentTarget).hasClass("secondary-link"),this.trigger("drilldown",clickInfo,options),this.hide()},show:function($toggle,$focus){$.when(this.hasRenderedDeferred).then(function(){PopTart.prototype.show.call(this,$toggle,$focus)}.bind(this))},render:function(){return $.when(this.timeSpanDfd).then(function(){this.$el.html(PopTart.prototype.template_menu);var template,showMilliseconds=!this.model.spanTimeRange.isRangeSnappedToSeconds(),timeFormat=showMilliseconds?"YYYY-MM-dd HH:mm:ss.TTT":"YYYY-MM-dd HH:mm:ss",earliest=i18n.format_date(time_utils.isoToDateObject(this.model.spanTimeRange.get("earliest_iso")),timeFormat),latest=i18n.format_date(time_utils.isoToDateObject(this.model.spanTimeRange.get("latest_iso")),timeFormat);this.isTimeSpan?(this.$el.addClass("time-span-drilldown"),showMilliseconds&&this.$el.removeClass("dropdown-menu-medium").addClass("dropdown-menu-wide"),template=this.cellDrilldownable?this.splitby_cell_template:this.time_span_row_template):template=this.cellDrilldownable?this.splitbyField?this.splitby_cell_template:this.cell_template:this.row_template;var compliledTemplate=this.compileTemplate(template);this.$el.append(compliledTemplate({_:_,showConstraints:"0"!=this.fieldClickedRank&&!_.isEmpty(this.constraints.keys),constraintKeys:this.constraints.keys,constraintValues:this.constraints.values,earliest:earliest,latest:latest,isTimeSpan:this.isTimeSpan,splitbyField:this.splitbyField,splitbyValue:this.splitbyValue,fieldClicked:this.fieldClicked,fieldValueClicked:this.fieldValueClicked,splunkUtil:splunkUtil})),this.hasRenderedDeferred.resolve()}.bind(this)),this},time_span_row_template:'                <ul>                    <li class="info">                        <%- splunkUtil.sprintf("%s to %s", earliest, latest) %>                    </li>                    <li>                        <a class="time_span primary-link" href="#"><%- _("View events").t() %></a>                        <a class="time_span secondary-link" href="#"><i class="icon-external"></i></a>                    </li>                    <li>                        <a class="time_span_reporting primary-link" href="#"><%- _("Narrow to this time range").t() %></a>                        <a class="time_span_reporting secondary-link" href="#"><i class="icon-external"></i></a>                    </li>                </ul>            ',splitby_cell_template:'                <% var text = splunkUtil.sprintf("%s = %s", splitbyField, splitbyValue); %>                <ul>                    <li class="info">                        <span class="field-value" title="<%- text %>"><%- text %></span>                    </li>                    <li>                        <a class="curr_exc_cell primary-link" href="#"><%- _("Exclude from results").t() %></a>                        <a class="curr_exc_cell secondary-link" href="#"><i class="icon-external"></i></a>                    </li>                    <li class="info">                        <% var splitText; %>                        <% if (isTimeSpan) { %>                            <% splitText = splunkUtil.sprintf("%s to %s", earliest, latest) %>                        <% } else { %>                            <% splitText = splunkUtil.sprintf("%s = %s", constraintKeys[0], constraintValues[0]) %>                        <% } %>                        <span class="field-value" title="<%- splitText %>"><%- splitText %></span>                        <span class="field-value" title="<%- text %>"><%- text %></span>                    </li>                    <li>                        <a class="splitby_curr_inc_cell primary-link" href="#"><%- _("View events").t() %></a>                        <a class="splitby_curr_inc_cell secondary-link" href="#"><i class="icon-external"></i></a>                    </li>                </ul>            ',row_template:'                <ul>                <% if (showConstraints) { %>                    <li class="info">                    <% for(var i = 0; i < constraintKeys.length; i++) { %>                        <%                            var key = constraintKeys[i],                                value = constraintValues[i],                                text = splunkUtil.sprintf("%s = %s", key, _.isArray(value) ? value.join(" | ") : value);                        %>                        <span class="field-value" title="<%- text %>"><%- text %></span>                    <% } %>                    </li>                <% } %>                    <li>                        <a class="curr_inc_val primary-link" href="#"><%- _("View events").t() %></a>                        <a class="curr_inc_val secondary-link" href="#"><i class="icon-external"></i></a>                    </li>                <% if (showConstraints) { %>                    <li>                        <a class="curr_exc_val primary-link" href="#"><%- _("Other events").t() %></a>                        <a class="curr_exc_val secondary-link" href="#"><i class="icon-external"></i></a>                    </li>                <% } %>                </ul>            ',cell_template:'                <ul>                <% if (fieldClicked) { %>                    <li class="info">                        <% var fieldInfoText = splunkUtil.sprintf("%s = %s", fieldClicked, fieldValueClicked); %>                        <span class="field-value" title="<%- fieldInfoText %>"><%- fieldInfoText %>                    </li>                <% } %>                                    <li>                        <a class="curr_inc_val primary-link" href="#"><%- _("View events").t() %></a>                        <a class="curr_inc_val secondary-link" href="#"><i class="icon-external"></i></a>                    </li>                    <li>                        <a class="curr_exc_val primary-link" href="#"><%- _("Other events").t() %></a>                        <a class="curr_exc_val secondary-link" href="#"><i class="icon-external"></i></a>                    </li>                    <li>                        <a class="curr_exc_cell primary-link" href="#"><%- _("Exclude from results").t() %></a>                        <a class="curr_exc_cell secondary-link" href="#"><i class="icon-external"></i></a>                    </li>                    <li>                        <a class="only_val primary-link" href="#"><%- _("New search").t() %></a>                        <a class="only_val secondary-link" href="#"><i class="icon-external"></i></a>                    </li>                                <% if (showConstraints) { %>                    <li class="info">                    <% for(var i = 0; i < constraintKeys.length; i++) { %>                        <%                            var key = constraintKeys[i],                                value = constraintValues[i],                                text = splunkUtil.sprintf("%s = %s", key, _.isArray(value) ? value.join(" | ") : value);                        %>                        <span class="field-value" title="<%- text %>"><%- text %></span>                    <% } %>                    </li>                    <li>                        <a class="curr_inc_con primary-link" href="#"><%- _("View events").t() %></a>                        <a class="curr_inc_con secondary-link" href="#"><i class="icon-external"></i></a>                    </li>                    <li>                        <a class="curr_exc_con primary-link" href="#"><%- _("Other events").t() %></a>                        <a class="curr_exc_con secondary-link" href="#"><i class="icon-external"></i></a>                    </li>                <% } %>                </ul>            '})}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},"views/shared/ResultsTableDrilldown":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__("shim/jquery"),__webpack_require__("require/underscore"),module,__webpack_require__("views/shared/results_table/ResultsTableMaster"),__webpack_require__("views/shared/ResultsTableDrillDownPopTart"),__webpack_require__("views/shared/delegates/Modalize"),__webpack_require__("util/keyboard")],void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function($,_,module,ResultsTable,ResultsTableDrillDownPopTart,Modalize,keyboard){return ResultsTable.extend({moduleId:module.i,initialize:function(){this.options.splitHighlight=!1,this.children.modalize=new Modalize({el:this.el,tbody:"tbody"}),this.model.state.set("isModalized",!1),this.pendingUpdate=!1,ResultsTable.prototype.initialize.call(this,this.options)},events:$.extend({},ResultsTable.prototype.events,{"keydown tbody tr":function(e){if(e.which===keyboard.KEYS.TAB&&this.model.state.get("isModalized")){var rowDrillDown="row"===this.model.config.get("display.statistics.drilldown");keyboard.handleCircularTabbing($(e.target).closest("tr"),e,rowDrillDown)}}}),startListening:function(){ResultsTable.prototype.startListening.apply(this,arguments),this.listenTo(this.children.modalize,"unmodalize",function(){this.model.state.set("isModalized",!1),this.pendingUpdate&&(this.pendingUpdate=!1,this.invalidate("updateViewPass"))}),this.listenTo(this.model.state,"change:isModalized",function(model,value){value||(this.children.tableDock&&this.children.tableDock.enable(),this.children.modalize.debouncedCleanup())})},deactivate:function(options){return this.active?(this.model.state.set("isModalized",!1),this.pendingUpdate=!1,ResultsTable.prototype.deactivate.apply(this,arguments)):ResultsTable.prototype.deactivate.apply(this,arguments)},emitDrilldownEvent:function(clickMeta){var $toggle,$pointTo,text,$clickTarget=$(clickMeta.originalEvent.target),rowDrillDown="row"===clickMeta.type,injectSpan=!1;if(rowDrillDown?($toggle=$clickTarget.closest("tr"),$pointTo=$clickTarget.is("tr")?$clickTarget.find("td[data-cell-index]").first():$clickTarget.closest("td")):$pointTo=$toggle=$clickTarget,this.children.resultsTableDrillDownPopTart){var popTartWasShown=this.children.resultsTableDrillDownPopTart.shown;if(this.children.resultsTableDrillDownPopTart.hide(),this.children.resultsTableDrillDownPopTart.remove(),this.stopListening(this.children.resultsTableDrillDownPopTart),delete this.children.resultsTableDrillDownPopTart,popTartWasShown)return}this.model.state.get("isModalized")||(this.model.state.set("isModalized",!0),this.children.tableDock&&this.children.tableDock.disable(),this.children.modalize.debouncedShow(clickMeta.rowIndex)),rowDrillDown||(injectSpan=(text=$.trim($clickTarget.text()))&&!$clickTarget.children().length),injectSpan&&($pointTo.html($("<span>").text(text)),$pointTo=$pointTo.find("span")),this.children.resultsTableDrillDownPopTart=new ResultsTableDrillDownPopTart({clickMeta:clickMeta,onHiddenRemove:!0,model:{application:this.model.application,results:this.model.searchData},scrollContainer:$pointTo.closest(".results-table"),ignoreToggleMouseDown:!0}),injectSpan&&this.listenToOnce(this.children.resultsTableDrillDownPopTart,"hidden",function(){$clickTarget.text(text)}),this.children.resultsTableDrillDownPopTart.render().appendTo($("body")).show($pointTo,{$toggle:$toggle}),this.listenTo(this.children.resultsTableDrillDownPopTart,"drilldown",_.bind(this.trigger,this,"drilldown"))},updateView:function(){this.model.state.get("isModalized")?this.pendingUpdate=!0:ResultsTable.prototype.updateView.apply(this,arguments)}})}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}}]);